/*!
RIGI JavaScript library v1.25
Copyright (C) Boxma IT B.V. Burgemeester Prinslaan 3 Ede, the Netherlands.
Build date: 05-11-2018 
*/
(function(){ if (typeof RIGI !== 'undefined') { return; }
var RIGI={DomNodeTypes:{Element:1,Attribute:2,Text:3,Comment:8,Document:9},SignatureNodeTypes:{Root:1,Text:2,Signature:3,Placeholder:4}};try{window.external&&"Rigi.Browser.ScriptingContext"==window.external?RIGI.scriptingContext=window.external:window.rigiScriptingContext&&(RIGI.scriptingContext=rigiScriptingContext)}catch(e){console.log("Can not get scripting context.")}RIGI.extend=function(e){e=e||{};for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var r in n)n.hasOwnProperty(r)&&("object"==typeof n[r]?(e[r]=e[r]||{},RIGI.extend(e[r],n[r])):e[r]=n[r])}return e},function(e){"use strict";for(var g=function(e,t,n,r){for(var i=t-1,o=0,s=r<10?r:10;++i<n;){var a=e.charCodeAt(i),u=a-48;if((u<0||s<=u)&&((u=-55+a)<10||r<=u)&&((u=-87+a)<10||r<=u))throw new RangeError;o=o*r+u}return o},O=function(e){for(var t=new Array(e),n=-1;++n<e;)t[n]=0;return t},p=void 0!==Math.trunc?Math.trunc:function(e){return e<0?0-Math.floor(0-e):Math.floor(e)},m=Math.pow,n=void 0!==Math.sign?Math.sign:function(e){return e<0?-1:0<e?1:0*e},r=Math.abs,I=Math.log,t=1/4503599627370496;1+t/2!=1;)t/=2;var D=2/t,v=I(D),S=67108864*m(2,p((p(v/I(2)+.5)-53)/2)+1)+1,M=function(e){var t=e-D+D;return e<t?t-1:t},P=function(e,t,n,r,i){var o=S*t,s=o-(o-t),a=t-s,u=S*n,l=u-(u-n),c=n-l,h=t*n,d=s*l-h+s*c+a*l+a*c,f=M(h/D),g=h-f*D+d;return g<0&&(g+=D,f-=1),(g+=e-D)<0?g+=D:f+=1,r[i]=g,f},U=function(e,t,n,r,i){if(n<=e)throw new RangeError;var o=e*D,s=o/n,a=o%n,u=M(s);return s===u&&n-a<a&&(u-=1),(a+=t-n)<0?a+=n:u+=1,a-=(s=M(a/n))*n,u+=s,r[i]=u,a},y=function(e){if(e!==Number(e)||p(e)!==e||e<2||36<e)throw new RangeError("radix argument must be an integer between 2 and 36")},B=function(e,t,n){for(var r=0,i=t;0<=--i;)r=U(r,e[i],n,e,i);return r},H=function(e,t,n,r){for(var i=-1;++i<n;)e=P(e,t[i],r,t,i);t[n]=e};function i(e,t,n){this.signum=e,this.magnitude=t,this.length=n}var F=function(e,t,n){return n<2?0===n?0:e<0?0-t[0]:t[0]:new i(e,t,n)},l=function(e,t,n,r,i,o){if(t!==i)return t<i?-1:1;for(var s=t;0<=--s;)if((void 0===e?n:e[s])!==(void 0===r?o:r[s]))return(void 0===e?n:e[s])<(void 0===r?o:r[s])?-1:1;return 0},o=function(e,t,n,r,i,o,s,a){if(e===i){var u=l(t,n,r,o,s,a);return e<0?0-u:u}return 0===e?0-i:e},u=function(e,t,n,r,i,o,s,a){if(0===e)return void 0===o?i<0?0-a:a:F(i,o,s);var u=!1;if(e!==i){if(u=!0,n===s)for(;0<s&&(void 0===t?r:t[s-1])===(void 0===o?a:o[s-1]);)s-=1;if(0===s)return F(0,O(0),0)}for(var l=s+(u?0:1),c=O(l),h=-1,d=0;++h<s;){var f=h<n?void 0===t?r:t[h]:0;(d+=(void 0===o?a:o[h])+(u?0-f:f-D))<0?(c[h]=D+d,d=u?-1:0):(c[h]=d,d=u?0:1)}for(0!==d&&(c[s]=d);0<l&&0===c[l-1];)l-=1;return F(i,c,l)},s=function(e,t,n,r,i,o,s,a){return 0<l(t,n,r,o,s,a)?u(i,o,s,a,e,t,n,r):u(e,t,n,r,i,o,s,a)},a=function(e,t,n,r,i,o,s,a){if(0===n||0===s)return F(0,O(0),0);var u=e<0?0-i:i;if(1===n&&1===(void 0===t?r:t[0]))return void 0===o?u<0?0-a:a:F(u,o,s);if(1===s&&1===(void 0===o?a:o[0]))return void 0===t?u<0?0-r:r:F(u,t,n);for(var l=n+s,c=O(l),h=-1;++h<s;){for(var d=0,f=-1;++f<n;){var g=0;0<=(d+=c[f+h]-D)?g=1:d+=D,d=g+P(d,void 0===t?r:t[f],void 0===o?a:o[h],c,f+h)}c[n+h]=d}for(;0<l&&0===c[l-1];)l-=1;return F(u,c,l)},c=function(e,t,n,r,i,o,s,a,u){if(0===s)throw new RangeError;if(0===n)return F(0,O(0),0);var l=e<0?0-i:i;if(1===s&&1===(void 0===o?a:o[0]))return u?void 0===t?l<0?0-r:r:F(l,t,n):F(0,O(0),0);for(var c=n+1,h=O(c+s+1),d=h,f=h,g=-1;++g<n;)f[g]=void 0===t?r:t[g];for(var p=-1;++p<s;)d[c+p]=void 0===o?a:o[p];var m=d[c+s-1],I=1;if(1<s&&(1<(I=M(D/(m+1)))&&(H(0,h,c+s,I),m=d[c+s-1]),m<M(D/2)))throw new RangeError;var v=n-s+1;v<0&&(v=0);for(var S=void 0,y=0,E=v;0<=--E;){var R=s+E,w=D-1,b=f[R];b!==m&&(U(f[R],f[R-1],m,f,R),w=f[R],f[R]=b);for(var T=0,N=0,G=E-1;++G<=R;){var x=f[G];N=P(N,w,d[c+G-E],f,G),(T+=x-f[G])<0?(f[G]=D+T,T=-1):(f[G]=T,T=0)}for(;0!==T;){w-=1;for(var C=0,L=E-1;++L<=R;)(C+=f[L]-D+d[c+L-E])<0?(f[L]=D+C,C=0):(f[L]=C,C=1);T+=C}u&&0!==w&&(0===y&&(S=O(y=E+1)),S[E]=w)}if(u)return 0===y?F(0,O(0),0):F(l,S,y);var _=n+1;if(1<I&&0!==B(f,_,I))throw new RangeError;for(;0<_&&0===f[_-1];)_-=1;if(0===_)return F(0,O(0),0);for(var k=O(_),A=-1;++A<_;)k[A]=f[A];return F(e,k,_)},h=function(e){return e};i.parseInt=function(e,t){void 0===t&&(t=10),y(t);var n=e.length;if(0===n)throw new RangeError;var r=1,i=e.charCodeAt(0),o=0;if(43===i&&(o=1),45===i&&(r=-(o=1)),0==(n-=o))throw new RangeError;var s=p(v/I(t)-.5);if(n<=s){var a=g(e,o,o+n,t);return r<0?0-a:a}var u=m(t,s);u*t<=D&&(s+=1,u*=t);for(var l=p((n-1)/s)+1,c=O(l),h=l,d=n;0<d;)c[h-=1]=g(e,o+(s<d?d-s:0),o+d,t),d-=s;for(var f=-1;++f<l;)H(c[f],c,f,u);for(;0<l&&0===c[l-1];)l-=1;return F(0===l?0:r,c,l)},i.compareTo=h("BigInteger.compareTo"),i.negate=h("BigInteger.negate"),i.add=h("BigInteger.add"),i.subtract=h("BigInteger.subtract"),i.multiply=h("BigInteger.multiply"),i.divide=h("BigInteger.divide"),i.remainder=h("BigInteger.remainder");var d=h("COMPARE_TO_NUMBER"),f=h("COMPARE_TO_BIG_INTEGER"),E=h("ADD_NUMBER"),R=h("ADD_BIG_INTEGER"),w=h("SUBTRACT_NUMBER"),b=h("SUBTRACT_BIG_INTEGER"),T=h("MULTIPLY_NUMBER"),N=h("MULTIPLY_BIG_INTEGER"),G=h("DIVIDE_NUMBER"),x=h("DIVIDE_BIG_INTEGER"),C=h("REMAINDER_NUMBER"),L=h("REMAINDER_BIG_INTEGER");function _(){}Number.prototype[i.compareTo]=function(e){return e.COMPARE_TO_NUMBER(this)},Number.prototype[i.negate]=function(){return 0-this},Number.prototype[i.add]=function(e){return e.ADD_NUMBER(this)},Number.prototype[i.subtract]=function(e){return e.SUBTRACT_NUMBER(this)},Number.prototype[i.multiply]=function(e){return e.MULTIPLY_NUMBER(this)},Number.prototype[i.divide]=function(e){return e.DIVIDE_NUMBER(this)},Number.prototype[i.remainder]=function(e){return e.REMAINDER_NUMBER(this)},Number.prototype[f]=function(e){return o(e.signum,e.magnitude,e.length,0,n(this),void 0,n(r(this)),r(this))},Number.prototype[R]=function(e){return s(e.signum,e.magnitude,e.length,0,n(this),void 0,n(r(this)),r(this))},Number.prototype[b]=function(e){return s(e.signum,e.magnitude,e.length,0,0-n(this),void 0,n(r(this)),r(this))},Number.prototype[N]=function(e){return a(e.signum,e.magnitude,e.length,0,n(this),void 0,n(r(this)),r(this))},Number.prototype[x]=function(e){return c(e.signum,e.magnitude,e.length,0,n(this),void 0,n(r(this)),r(this),!0)},Number.prototype[L]=function(e){return c(e.signum,e.magnitude,e.length,0,n(this),void 0,n(r(this)),r(this),!1)},Number.prototype[d]=function(e){return e<this?-1:this<e?1:0},Number.prototype[E]=function(e){var t=e+this;return-D<t&&t<+D?t:s(n(e),void 0,n(r(e)),r(e),n(this),void 0,n(r(this)),r(this))},Number.prototype[w]=function(e){var t=e-this;return-D<t&&t<+D?t:s(n(e),void 0,n(r(e)),r(e),0-n(this),void 0,n(r(this)),r(this))},Number.prototype[T]=function(e){var t=0+e*this;return-D<t&&t<+D?t:a(n(e),void 0,n(r(e)),r(e),n(this),void 0,n(r(this)),r(this))},Number.prototype[G]=function(e){if(0+this===0)throw new RangeError;return 0+p(e/this)},Number.prototype[C]=function(e){if(0+this===0)throw new RangeError;return 0+e%this},_.prototype=Number.prototype,(i.prototype=new _).toString=function(e){return void 0===e&&(e=10),y(e),function(e,t,n,r){var i=e<0?"-":"",o=n;if(0===o)return"0";if(1===o)return i+=t[0].toString(r);var s=p(v/I(r)-.5),a=m(r,s);if(a*r<=D&&(s+=1,a*=r),a*r<=D)throw new RangeError;for(var u=o+p((o-1)/s)+1,l=O(u),c=-1;++c<o;)l[c]=t[c];for(var h=u;0!==o;){for(var d=B(l,o,a);0<o&&0===l[o-1];)o-=1;l[h-=1]=d}for(i+=l[h].toString(r);++h<u;){for(var f=l[h].toString(r),g=s-f.length;0<=--g;)i+="0";i+=f}return i}(this.signum,this.magnitude,this.length,e)},i.prototype[i.compareTo]=function(e){return e.COMPARE_TO_BIG_INTEGER(this)},i.prototype[i.negate]=function(){return F(0-this.signum,this.magnitude,this.length)},i.prototype[i.add]=function(e){return e.ADD_BIG_INTEGER(this)},i.prototype[i.subtract]=function(e){return e.SUBTRACT_BIG_INTEGER(this)},i.prototype[i.multiply]=function(e){return e.MULTIPLY_BIG_INTEGER(this)},i.prototype[i.divide]=function(e){return e.DIVIDE_BIG_INTEGER(this)},i.prototype[i.remainder]=function(e){return e.REMAINDER_BIG_INTEGER(this)},i.prototype[f]=function(e){return o(e.signum,e.magnitude,e.length,0,this.signum,this.magnitude,this.length,0)},i.prototype[R]=function(e){return s(e.signum,e.magnitude,e.length,0,this.signum,this.magnitude,this.length,0)},i.prototype[b]=function(e){return s(e.signum,e.magnitude,e.length,0,0-this.signum,this.magnitude,this.length,0)},i.prototype[N]=function(e){return a(e.signum,e.magnitude,e.length,0,this.signum,this.magnitude,this.length,0)},i.prototype[x]=function(e){return c(e.signum,e.magnitude,e.length,0,this.signum,this.magnitude,this.length,0,!0)},i.prototype[L]=function(e){return c(e.signum,e.magnitude,e.length,0,this.signum,this.magnitude,this.length,0,!1)},i.prototype[d]=function(e){return o(n(e),void 0,n(r(e)),r(e),this.signum,this.magnitude,this.length,0)},i.prototype[E]=function(e){return s(n(e),void 0,n(r(e)),r(e),this.signum,this.magnitude,this.length,0)},i.prototype[w]=function(e){return s(n(e),void 0,n(r(e)),r(e),0-this.signum,this.magnitude,this.length,0)},i.prototype[T]=function(e){return a(n(e),void 0,n(r(e)),r(e),this.signum,this.magnitude,this.length,0)},i.prototype[G]=function(e){return c(n(e),void 0,n(r(e)),r(e),this.signum,this.magnitude,this.length,0,!0)},i.prototype[C]=function(e){return c(n(e),void 0,n(r(e)),r(e),this.signum,this.magnitude,this.length,0,!1)},e.BigInteger=i}(this);var Channel=function(){"use strict";var c=Math.floor(1000001*Math.random()),h={};function b(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}var T={},e=function(e){try{var t=JSON.parse(e.data);if("object"!=typeof t||null===t)throw"malformed"}catch(e){return}var n,r,i,o=e.source,s=e.origin;if("string"==typeof t.method){var a=t.method.split("::");2==a.length?(n=a[0],i=a[1]):i=t.method}if(void 0!==t.id&&(r=t.id),"string"==typeof i){var u=!1;if(h[s]&&h[s][n])for(var l=0;l<h[s][n].length;l++)if(h[s][n][l].win===o){h[s][n][l].handler(s,i,t),u=!0;break}if(!u&&h["*"]&&h["*"][n])for(l=0;l<h["*"][n].length;l++)if(h["*"][n][l].win===o){h["*"][n][l].handler(s,i,t);break}}else void 0!==r&&T[r]&&T[r](s,i,t)};return window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e),{build:function(v){var S=function(e){if(v.debugOutput&&window.console&&window.console.log){try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(e){}window.console.log("["+n+"] "+e)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof v)throw"Channel build invoked without a proper object argument";if(!v.window||!v.window.postMessage)throw"Channel.build() called without a valid window argument";if(window===v.window)throw"target window is same as present window -- not allowed";var e,t=!1;"string"==typeof v.origin&&("*"===v.origin?t=!0:null!==(e=v.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(v.origin=e[0].toLowerCase(),t=!0));if(!t)throw"Channel.build() called with an invalid origin";if(void 0!==v.scope){if("string"!=typeof v.scope)throw"scope, when specified, must be a string";if(1<v.scope.split("::").length)throw"scope may not contain double colons: '::'"}var n=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}(),y={},E={},R={},r=!1,i=[],u=function(e,t,n){if("function"==typeof v.gotMessageObserver)try{v.gotMessageObserver(e,n)}catch(e){S("gotMessageObserver() raised an exception: "+e.toString())}if(n.id&&t){if(y[t]){var r=(f=n.id,g=e,p=n.callbacks?n.callbacks:[],I=m=!1,{origin:g,invoke:function(e,t){if(!R[f])throw"attempting to invoke a callback of a nonexistent transaction: "+f;for(var n=!1,r=0;r<p.length;r++)if(e===p[r]){n=!0;break}if(!n)throw"request supports no such callback '"+e+"'";w({id:f,callback:e,params:t})},error:function(e,t){if(I=!0,!R[f])throw"error called for nonexistent message: "+f;delete R[f],w({id:f,error:e,message:t})},complete:function(e){if(I=!0,!R[f])throw"complete called for nonexistent message: "+f;delete R[f],w({id:f,result:e})},delayReturn:function(e){return"boolean"==typeof e&&(m=!0===e),m},completed:function(){return I}});R[n.id]={};try{if(n.callbacks&&b(n.callbacks)&&0<n.callbacks.length)for(var i=0;i<n.callbacks.length;i++){for(var o=n.callbacks[i],s=n.params,a=o.split("/"),u=0;u<a.length-1;u++){var l=a[u];"object"!=typeof s[l]&&(s[l]={}),s=s[l]}s[a[a.length-1]]=function(){var t=o;return function(e){return r.invoke(t,e)}}()}var c=y[t](r,n.params);r.delayReturn()||r.completed()||r.complete(c)}catch(t){var h="runtime_error",d=null;if("string"==typeof t?d=t:"object"==typeof t&&(t&&b(t)&&2==t.length?(h=t[0],d=t[1]):"string"==typeof t.error&&(h=t.error,t.message?"string"==typeof t.message?d=t.message:t=t.message:d="")),null===d)try{void 0===(d=JSON.stringify(t))&&(d=t.toString())}catch(e){d=t.toString()}r.error(h,d)}}}else n.id&&n.callback?E[n.id]&&E[n.id].callbacks&&E[n.id].callbacks[n.callback]?E[n.id].callbacks[n.callback](n.params):S("ignoring invalid callback, id:"+n.id+" ("+n.callback+")"):n.id?E[n.id]?(n.error?(0,E[n.id].error)(n.error,n.message):void 0!==n.result?(0,E[n.id].success)(n.result):(0,E[n.id].success)(),delete E[n.id],delete T[n.id]):S("ignoring invalid response: "+n.id):t&&y[t]&&y[t]({origin:e},n.params);var f,g,p,m,I};!function(n,e,t,r){function i(e){for(var t=0;t<e.length;t++)if(e[t].win===n)return!0;return!1}var o=!1;if("*"===e){for(var s in h)if(h.hasOwnProperty(s)&&"*"!==s&&"object"==typeof h[s][t]&&(o=i(h[s][t])))break}else h["*"]&&h["*"][t]&&(o=i(h["*"][t])),!o&&h[e]&&h[e][t]&&(o=i(h[e][t]));if(o)throw"A channel is already bound to the same window which overlaps with origin '"+e+"' and has scope '"+t+"'";"object"!=typeof h[e]&&(h[e]={}),"object"!=typeof h[e][t]&&(h[e][t]=[]),h[e][t].push({win:n,handler:r})}(v.window,v.origin,"string"==typeof v.scope?v.scope:"",u);var l=function(e){return"string"==typeof v.scope&&v.scope.length&&(e=[v.scope,e].join("::")),e},w=function(e,t){if(!e)throw"postMessage called with null message";if(S((r?"post  ":"queue ")+" message: "+JSON.stringify(e)),t||r){if("function"==typeof v.postMessageObserver)try{v.postMessageObserver(v.origin,e)}catch(e){S("postMessageObserver() raised an exception: "+e.toString())}v.window.postMessage(JSON.stringify(e),v.origin)}else i.push(e)},o={unbind:function(e){if(y[e]){if(!delete y[e])throw"can't delete method: "+e;return!0}return!1},bind:function(e,t){if(!e||"string"!=typeof e)throw"'method' argument to bind must be string";if(!t||"function"!=typeof t)throw"callback missing from bind params";return y[e]=t,this},call:function(e){if(!e)throw"missing arguments to call function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to call must be string";if(!e.success||"function"!=typeof e.success)throw"'success' callback missing from call";var i={},o=[],s=function(e,t){if("object"==typeof t)for(var n in t)if(t.hasOwnProperty(n)){var r=e+(e.length?"/":"")+n;"function"==typeof t[n]?(i[r]=t[n],o.push(r),delete t[n]):"object"==typeof t[n]&&s(r,t[n])}};s("",e.params);var t,n,r,a={id:c,method:l(e.method),params:e.params};o.length&&(a.callbacks=o),e.timeout&&(t=c,n=e.timeout,r=l(e.method),window.setTimeout(function(){if(E[t]){var e="timeout ("+n+"ms) exceeded on method '"+r+"'";(0,E[t].error)("timeout_error",e),delete E[t],delete T[t]}},n)),E[c]={callbacks:i,error:e.error,success:e.success},T[c]=u,c++,w(a)},notify:function(e){if(!e)throw"missing arguments to notify function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to notify must be string";w({method:l(e.method),params:e.params})},destroy:function(){!function(e,t,n){for(var r=h[t][n],i=0;i<r.length;i++)r[i].win===e&&r.splice(i,1);0===h[t][n].length&&delete h[t][n]}(v.window,v.origin,"string"==typeof v.scope?v.scope:""),window.removeEventListener?window.removeEventListener("message",u,!1):window.detachEvent&&window.detachEvent("onmessage",u),r=!1,y={},R={},E={},v.origin=null,i=[],S("channel destroyed"),n=""}};return o.bind("__ready",function(e,t){if(S("ready msg received"),r&&!v.reconnect)throw"received ready message while in ready state.  help!";for(r=!1,n.length<6&&(n+="ping"===t?"-R":"-L"),v.reconnect||o.unbind("__ready"),r=!0,S("ready msg accepted."),"ping"===t&&o.notify({method:"__ready",params:"pong"});i.length;)w(i.pop());"function"==typeof v.onReady&&v.onReady(o)}),setTimeout(function(){w({method:l("__ready"),params:"ping"},!0)},0),o}}}();function RIGI_scrollIntoView(e,t){if(e.ownerDocument){var n=e.ownerDocument.defaultView;if(!arguments.length||"object"!=typeof t)return e.scrollIntoView.apply(e,arguments);var r=e.getBoundingClientRect(),i=r.bottom,o=r.top-n.innerHeight,s=r.right,a=r.left-n.innerWidth,u=!0,l=!0;void 0===t.vertical&&(t.vertical=.5),void 0===t.horizontal&&(t.horizontal=.5),void 0===t.evenIfViewed&&(t.evenIfViewed=!1),0<i&&i<=e.offsetHeight?l&&(n.scrollBy(0,i-e.offsetHeight),l=!1):o<0&&o>=-e.offsetHeight&&l&&(n.scrollBy(0,o+e.offsetHeight),l=!1),0<s&&s<=e.offsetWidth?u&&(n.scrollBy(s-e.offsetWidth,0),u=!1):a<0&&a>=-e.offsetWidth&&u&&(n.scrollBy(a+e.offsetWidth,0),u=!1),l&&(t.evenIfViewed||(i<=0||0<=o))&&n.scroll(n.scrollX,n.scrollY+r.top-(n.innerHeight-e.offsetHeight)*t.vertical),u&&(t.evenIfViewed||(s<=0||a<=0))&&n.scroll(n.scrollX+r.left-(n.innerWidth-e.offsetWidth)*t.horizontal,n.scrollY)}}function RIGI_Translate(e,t){return RIGI.Core.Translate(e,t)}function RIGI_TranslateMany(e){return RIGI.Core.TranslateMany(e)}function RIGI_Select(e,t){return RIGI.Core.Select(e,t)}function RIGI_Initialize(e){return RIGI.Core.Initialize(e)}function RIGI_RenderScreenshot(e){var t={ticket:0,storeInDom:!1,fixedWidth:!1,fixedHeight:!1};void 0!==e&&(t=e),(new RIGI.Screenshots.ScreenshotEngine).render(t)}function RIGI_Log(e){RIGI.Events.OnLog(e)}!function(e){function t(t){return"object"!=typeof t||null===t||t instanceof Array?n(t):"{"+Object.keys(t).map(function(e){return"function"==typeof t[e]?null:'"'+e+'":'+n(t[e])}).filter(function(e){return e})+"}"}function n(e){switch(typeof e){case"string":return'"'+e.replace(/\\/g,"\\\\").replace('"','\\"')+'"';case"number":case"boolean":return""+e;case"function":return"null";case"object":return e instanceof Date?'"'+e.toISOString()+'"':e instanceof Array?"["+e.map(n).join(",")+"]":null===e?"null":t(e)}}e.extend(e,{json:{stringify:function(e){return t(e)}}})}(RIGI),function(){var u,r="&ui-state=dialog";RIGI.Path=u={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=this.parseUrl(e||location.href),n=e?t:location,r=t.hash;return r="#"===r?"":r,n.protocol+t.doubleSlash+n.host+(""!==n.protocol&&"/"!==n.pathname.substring(0,1)?"/":"")+n.pathname+n.search+r},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(e){if("object"==typeof e)return e;var t=u.urlParseRE.exec(e||"")||[];return{href:t[0]||"",hrefNoHash:t[1]||"",hrefNoSearch:t[2]||"",domain:t[3]||"",protocol:t[4]||"",doubleSlash:t[5]||"",authority:t[6]||"",username:t[8]||"",password:t[9]||"",host:t[10]||"",hostname:t[11]||"",port:t[12]||"",pathname:t[13]||"",directory:t[14]||"",filename:t[15]||"",search:t[16]||"",hash:t[17]||""}},makePathAbsolute:function(e,t){var n,r,i,o;if(e&&"/"===e.charAt(0))return e;for(e=e||"",n=(t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?t.split("/"):[],r=e.split("/"),i=0;i<r.length;i++)switch(o=r[i]){case".":break;case"..":n.length&&n.pop();break;default:n.push(o)}return"/"+n.join("/")},isSameDomain:function(e,t){return u.parseUrl(e).domain.toLowerCase()===u.parseUrl(t).domain.toLowerCase()},isRelativeUrl:function(e){return""===u.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==u.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!u.isRelativeUrl(e))return e;t||(t=this.documentBase);var n=u.parseUrl(e),r=u.parseUrl(t),i=n.protocol||r.protocol,o=n.protocol?n.doubleSlash:n.doubleSlash||r.doubleSlash,s=n.authority||r.authority,a=""!==n.pathname;return i+o+s+u.makePathAbsolute(n.pathname||r.filename,r.pathname)+(n.search||!a&&r.search||"")+n.hash},addSearchParams:function(e,t){var n=u.parseUrl(e),r="object"==typeof t?$.param(t):t,i=n.search||"?";return n.hrefNoSearch+i+("?"!==i.charAt(i.length-1)?"&":"")+r+(n.hash||"")},convertUrlToDataUrl:function(e){var t=e,n=u.parseUrl(e);return u.isEmbeddedPage(n)?t=n.hash.split(r)[0].replace(/^#/,"").replace(/\?.*$/,""):u.isSameDomain(n,this.documentBase)&&(t=n.hrefNoHash.replace(this.documentBase.domain,"").split(r)[0]),window.decodeURIComponent(t)},get:function(e){return void 0===e&&(e=u.parseLocation().hash),u.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return u.stripHash(e.replace(/\?.*$/,"").replace(r,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=u.parseUrl(e);return!(!t.protocol||t.domain.toLowerCase()===this.documentUrl.domain.toLowerCase())},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=u.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(e){var t="#"===e.substring(0,1);return t&&(e=e.substring(1)),(t?"#":"")+e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(e){return e&&e.split(r)[0]}},u.documentUrl=u.parseLocation(),u.documentBase=u.documentUrl}(),RIGI.Repository=function(){var u={},l=0,n={};return n.Node=function(e,t){this.element=e,(this.attribute=t)?(this.tree=t.rigiSignatureTree,this.nodeType=RIGI.DomNodeTypes.Attribute):(this.tree=e.rigiSignatureTree,this.nodeType=RIGI.DomNodeTypes.Element)},n.clear=function(){u={},l=0},n.hasEntries=function(){return 0<l},n.add=function(e){for(var t=e.tree.getSignatures(),n=0;n<t.length;n++){var r=t[n],i=u[r],o=!1;i||(i=new Array,o=!0);for(var s=!1,a=0;a<i.length;a++)if(i[a]==e){s=!0;break}s||(i.push(e),o&&l++),u[r]=i}},n.getSignatures=function(){var e=[];if(!n.hasEntries())return e;for(var t in u)e.push(t);return e},n.getNodes=function(e){return 0<l?u[e]:null},n}(),RIGI.Config={TimerInterval:2e3,EnableMutationObserver:!0,MinimumRescanTimespan:200,EnableTimer:!0,SignatureAttributes:["value","title","text","alt","placeholder","label","data-rg-validation"]},RIGI.Signatures=function(e){function t(e){this.format=e,this.lookupTable={},this.lookupTableInt={},this.powers=[];for(var t=0;t<this.format.IdSet.length;t++)this.lookupTable[this.format.IdSet[t]]=t;var n=1,r=this.format.IdSet.length;n=n[BigInteger.add](0);for(t=0;t<64;t++)this.powers.push(n),n=n[BigInteger.multiply](r);this.RX_PH_START=new RegExp("^"+this.format.PhStart),this.RX_PH_END=new RegExp("^"+this.format.PhEnd),this.RX_SIGSTART=new RegExp("^"+this.format.StartEnd+this.format.IdPrefix+"(["+this.format.IdSet+"]+)"+this.format.Suffix),this.RX_SIGEND=new RegExp("^("+this.format.StartEnd+")("+this.format.PhStart+")?("+this.format.PhEnd+")?(?!"+this.format.IdPrefix+"["+function(e,t){for(var n=[],r=0;r<t.length;r++)n.push(t[r]),r+1<t.length&&n.push(e);return n.join("")}("|",this.format.IdSet)+"])"),this.RX_HAS_SIGNATURE=new RegExp(this.format.StartEnd+this.format.IdPrefix+"(["+this.format.IdSet+"]+)"+this.format.Suffix)}t.prototype.decodeSignature=function(e){for(var t=0,n=e.length,r=0;r<n;r++){var i=this.lookupTable[e[r]];if(null!=i&&0<i){var o=this.powers[n-r-1];o=i[BigInteger.multiply](o),t=t[BigInteger.add](o)}}return t.toString(10)},t.prototype.encodeSignature=function(e){for(var t=[],n=BigInteger.parseInt(e),r=null,i=this.format.IdSet.length;0<n[BigInteger.compareTo](0);)r=n[BigInteger.remainder](i),n=n[BigInteger.divide](i),t.push(this.format.IdSet[r]);return t.reverse(),t.join("")},t.prototype.attachSignature=function(e,t){var n=[];return n.push(this.format.StartEnd),n.push(this.format.IdPrefix),n.push(this.encodeSignature(t)),n.push(this.format.Suffix),n.push(e),n.push(this.format.StartEnd),n.join("")},t.prototype.isSignatureChar=function(e){return null!=this.signatureChars[e]};var n=[];n.push({IdSet:"​‌‍⁪⁫⁬⁭⁮⁯",StartEnd:"\ufeff\u2029\ufeff",IdPrefix:"",Suffix:"\ufeff",PhStart:"​​​",PhEnd:"‌‌‌"}),n.push({IdSet:"​‌‍",StartEnd:"\ufeff\ufeff",IdPrefix:"",Suffix:"\ufeff",PhStart:"​​​",PhEnd:"‌‌‌"}),n.push({IdSet:"​‌‍",StartEnd:"⁪⁪",IdPrefix:"⁪",Suffix:"⁪",PhStart:"​​​",PhEnd:"‌‌‌"}),n.push({IdSet:"0123456789abcdefghijklmnopqrstuvwxyz",StartEnd:"%#%",IdPrefix:"-",Suffix:"-",PhStart:"!!!",PhEnd:"'''"}),n.push({IdSet:"​‌‍",StartEnd:"\ufeff\ufeff",IdPrefix:"",Suffix:"\ufeff",PhStart:"​​​",PhEnd:"‌‌‌"});var r=n[2];return{getCurrentFormat:function(){return new t(r)},setCurrentFormat:function(e){r=n[e-1]}}}(),RIGI.Events=function(){var r={};function i(e,t){var n=null;return r[e].forEach(function(e){n=e.callback(t)}),n}var o={ELEMENT_SELECTED:"onElementSelected",GET_TRANSLATION:"onGetTranslation",PUBLISH_SIGNATURES:"onPublishSignatures",SCREENSHOT_FINISHED:"onScreenshotFinished",LOADED:"onLoaded",INITIALIZED:"onInitialized",LOG:"onLog",HOTKEY:"onHotkey"};return r[o.ELEMENT_SELECTED]=[],r[o.GET_TRANSLATION]=[],r[o.PUBLISH_SIGNATURES]=[],r[o.LOG]=[],r[o.SCREENSHOT_FINISHED]=[],r[o.LOADED]=[],r[o.INITIALIZED]=[],r[o.HOTKEY]=[],o.addEventListener=function(e,t){r[e]&&r[e].push({callback:t})},o.IsSubscribed=function(e){return null!=r[e]},o.OnElementSelected=function(e){i(o.ELEMENT_SELECTED,e)},o.OnGetTranslation=function(e){return i(o.GET_TRANSLATION,e)},o.OnPublishSignatures=function(e){i(o.PUBLISH_SIGNATURES,e)},o.OnLoaded=function(){i(o.LOADED)},o.OnInitialized=function(){i(o.INITIALIZED)},o.OnLog=function(e){i(o.LOG,e)},o.OnScreenshotFinished=function(e,t,n,r){i(o.SCREENSHOT_FINISHED,{chunk:e,chunkNum:t,totalChunks:n,ticket:r})},o.OnHotkeyPressed=function(e){i(o.HOTKEY,e)},o}(),RIGI.PassoloBinding=function(){try{var t=RIGI.scriptingContext||window.rigiScriptingContext;t&&(RIGI.Events.addEventListener(RIGI.Events.ELEMENT_SELECTED,function(e){t.rigiElementSelected(e)}),RIGI.Events.addEventListener(RIGI.Events.GET_TRANSLATION,function(e){return t.rigiGetTranslation(e)}),RIGI.Events.addEventListener(RIGI.Events.PUBLISH_SIGNATURES,function(e){t.rigiPublishSignatures(e)}),RIGI.Events.addEventListener(RIGI.Events.LOG,function(e){t.rigiLog(e)}),RIGI.Events.addEventListener(RIGI.Events.SCREENSHOT_FINISHED,function(e){t.rigiScreenshotFinished(e.chunk,e.chunkNum,e.totalChunks,e.ticket)}))}catch(e){console.log(e.message)}}(),RIGI.ChannelBinding=function(){var e=window.opener||window.parent;if(null!=e&&e!=window){var t=Channel.build({window:e,origin:"*",scope:"rigiScope"});t.bind("initialize",function(e,t){RIGI_Initialize(t)}),t.bind("takeScreenshot",function(e,t){RIGI_RenderScreenshot(t)}),t.bind("translate",function(e,t){RIGI_Translate(t.signature,t.translation)}),t.bind("translateMany",function(e,t){RIGI_TranslateMany(t)}),t.bind("select",function(e,t){RIGI_Select(t,!0)}),t.bind("prepareScreenshot",function(e){RIGI_PrepareScreenshot()}),RIGI.Events.addEventListener(RIGI.Events.ELEMENT_SELECTED,function(e){t.notify({method:"onElementSelected",params:e})}),RIGI.Events.addEventListener(RIGI.Events.PUBLISH_SIGNATURES,function(e){t.notify({method:"onPublishSignatures",params:e})}),RIGI.Events.addEventListener(RIGI.Events.LOADED,function(e){t.notify({method:"onLoaded"})}),RIGI.Events.addEventListener(RIGI.Events.INITIALIZED,function(){t.notify({method:"onInitialized"})}),RIGI.Events.addEventListener(RIGI.Events.HOTKEY,function(e){t.notify({method:"onHotkey",params:e})}),RIGI.Events.addEventListener(RIGI.Events.SCREENSHOT_FINISHED,function(e){t.notify({method:"onScreenshotFinished",params:e})}),RIGI.Events.addEventListener(RIGI.Events.LOG,function(e){t.notify({method:"onLog",params:e})})}}(),RIGI.Popups=function(){try{RIGI.scriptingContext&&(window.close=function(){RIGI.scriptingContext.rigiCloseTab()})}catch(e){}}(),RIGI.Utils=function(){var o=function(){};return o.addClass=function(e,t){e&&e.classList.add(t)},o.removeClass=function(e,t){e&&e.className&&e.classList.remove(t)},o.hasClass=function(e,t){if(!e||!e.className)return!1;try{return e.classList.contains(t)}catch(e){return console.log(e.toString()),!1}},o.hasSignatures=function(e){return null!=RIGI.Signatures.getCurrentFormat().RX_HAS_SIGNATURE.exec(e)},o.visitSignatureAttributes=function(e,t){for(var n=0;n<RIGI.Config.SignatureAttributes.length;n++){var r=e.getAttributeNode(RIGI.Config.SignatureAttributes[n]);null!=r&&t(r,o.hasSignatures(r.value))}},o.generateUUID=function(){var n=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(n+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})},o.StringBuilder=function(){var s=[];this.arr=s,this.append=function(e){s.push(e)},this.appendLine=function(e){s.push(e),s.push("\r\n")},this.clear=function(e){s=[]},this.isEmpty=function(){return 0==s.length},this.toString=function(){return s.join("")},this.toStringChunks=function(e){var t=s.join(""),n=Math.ceil(t.length/e),r=new Array(n);if(1==n)r[0]=t;else for(var i=0;i<n;i++){var o=i*e;r[i]=t.substring(o,o+e)}return r}},o.Stack=function(){var t=[];this.push=function(e){t.push(e)},this.pop=function(){return t.pop()},this.peek=function(){return 0==t.length?null:t[t.length-1]},this.isEmpty=function(){return 0==t.length},this.size=function(){return t.length},this.clear=function(){t=[]}},o.prepareRegex=function(e){for(var t="",n=0;n<e.length;n++)switch(e[n]){case"A":t+=RIGI.Config.SignatureSettings.A;break;case"B":t+=RIGI.Config.SignatureSettings.B;break;case"C":t+=RIGI.Config.SignatureSettings.C;break;case"D":t+=RIGI.Config.SignatureSettings.D;break;default:t+=e[n]}return new RegExp(t)},o.getDateTime=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),o=e.getMinutes(),s=e.getSeconds();if(1==n.toString().length)n="0"+n;if(1==r.toString().length)r="0"+r;if(1==i.toString().length)i="0"+i;if(1==o.toString().length)o="0"+o;if(1==s.toString().length)s="0"+s;return t+"/"+n+"/"+r+" "+i+":"+o+":"+s},o.htmlEncode=function(e){for(var t=new o.StringBuilder,n=0;n<e.length;n++){var r=e.charAt(n);switch(r){case"&":t.append("&amp;");break;case'"':t.append("&quot;");break;case"'":t.append("&#39;");break;case"<":t.append("&lt;");break;case">":t.append("&gt;");break;default:t.append(r)}}return t.toString()},o.escapeQuotes=function(e){return e=(e=e.replace(/"/g,"&quot;")).replace(/'/g,"&apos;")},o.createCss=function(e){var t=(e=e||window.document).getElementById("_rigijscss");if(!t){(t=e.createElement("style")).id="_rigijscss",t.type="text/css",t.innerHTML=".rigiElementSelected {background-color: #FDFF47 !important; color: #000000 !important; } .rigiElement:hover {background-color: #8AC007 !important; color: #000000 !important; }.rigiElementSelected img { border: solid 2px #fff000; }.rigiElement:hover img { border: solid 2px #8AC007; }.rigiElementSelected[data-rg-validation] { background-color: rgba(253, 255, 71, 0.4) !important; }.rigiElement[data-rg-validation]:hover { background-color: rgba(138, 192, 7, 0.4) !important; }";var n=e.getElementsByTagName("head")[0];n&&n.appendChild(t)}},o.getAllDocumentsRecursive=function(e,t){t.push(e);for(var n=e.getElementsByTagName("IFRAME"),r=e.getElementsByTagName("FRAME"),i=0;i<n.length;i++)o.getAllDocumentsRecursive(n[i].contentDocument,t);for(i=0;i<r.length;i++)o.getAllDocumentsRecursive(r[i].contentWindow.document,t)},o.getAllDocuments=function(){var e=[];return o.getAllDocumentsRecursive(document,e),e},o.isHTML=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return Array.from(t.body.childNodes).some(function(e){return 1===e.nodeType})},o}(),RIGI.SignatureTree=function(){var e=0;return function(){this.children=[],this.treeID=++e,this.isReadOnly=!1,this.hasSignature=function(t){var n=!1;return this.traverse(this,function(e){e.type==RIGI.SignatureNodeTypes.Signature&&e.value==t&&(n=!0)}),n},this.getSignatures=function(){var t=[];return this.traverse(this,function(e){e.type==RIGI.SignatureNodeTypes.Signature&&t.push(e.value)}),t},this.getSignatureNode=function(t){var n=null;return this.traverse(this,function(e){e.type==RIGI.SignatureNodeTypes.Signature&&e.value==t&&(n=e)}),n},this.translate=function(t,n){this.traverse(this,function(e){e.type==RIGI.SignatureNodeTypes.Signature&&e.value==t&&(e.text=n)})},this.fillEmptyPlaceholders=function(e){var n={},r=null;this.traverse(this,function(e){e.type==RIGI.SignatureNodeTypes.Placeholder&&(r=e.parent).type==RIGI.SignatureNodeTypes.Signature&&(n[r.value+":"+e.id]=e)}),this.traverse(e,function(e){if(e.type==RIGI.SignatureNodeTypes.Placeholder&&(r=e.parent).type==RIGI.SignatureNodeTypes.Signature&&1==e.children.length&&e.children[0].type==RIGI.SignatureNodeTypes.Text){var t=r.value+":"+e.id;n[t]&&(e.children=n[t].children)}})},this.translateTree=function(t,e){var n=!1,r=e.children[0];if(r&&r.value==t)return this.fillEmptyPlaceholders(e),this.traverse(this,function(e){e.type==RIGI.SignatureNodeTypes.Signature&&e.value==t&&(e.text=r.text,e.children=r.children,n=!0)}),n},this.toString=function(e){return this.getNodeText(this,e).replace(/\{\{RIGIPH\:\d+\}\}/g,"??")},this.getNodeText=function(e,t){var n=new RIGI.Utils.StringBuilder,r=!1,i=RIGI.Signatures.getCurrentFormat();switch(e.type){case RIGI.SignatureNodeTypes.Text:n.append(e.text);break;case RIGI.SignatureNodeTypes.Signature:n.append(this.getSignatureNodeText(e,t)),r=!0;break;case RIGI.SignatureNodeTypes.Placeholder:t&&n.append(i.format.PhStart)}if(!r&&null!=e.children)for(var o=0;o<e.children.length;o++){var s=e.children[o];n.append(this.getNodeText(s,t))}return t&&e.type==RIGI.SignatureNodeTypes.Placeholder&&n.append(i.format.PhEnd),n.toString()},this.getSignatureNodeText=function(e,t){var n=e.text||"";if(t&&(n=RIGI.Signatures.getCurrentFormat().attachSignature(n,e.value)),null!=e.children&&0<e.children.length)for(var r=0;r<e.children.length;r++){var i=this.getNodeText(e.children[r],t),o=new RegExp("{{RIGIPH:"+r+"}}");n=n.replace(o,i)}return n},this.getSignatureText=function(e){var t=this.getSignatureNode(e);return t?this.getSignatureNodeText(t):null},this.traverse=function(e,t){if(t(e),null!=e.children)for(var n=0;n<e.children.length;n++)this.traverse(e.children[n],t)}}}(),RIGI.Parser=function(){var u=RIGI.SignatureNodeTypes.Root,l=RIGI.SignatureNodeTypes.Text,c=RIGI.SignatureNodeTypes.Signature,h=RIGI.SignatureNodeTypes.Placeholder,d={parse:function(t){RIGI.Signatures.getCurrentFormat();var e=d.tokenize(t),n=new RIGI.Utils.Stack,r=new RIGI.SignatureTree;r.type=u,n.push(r);try{for(var i=0;i<e.length;i++){var o=e[i];switch(o.type){case 2:var s=n.peek(),a={type:c,value:o.value,text:"",children:[]};s.type==c&&(s.text+="{{RIGIPH:"+s.children.length+"}}"),s.children.push(a),n.push(a);break;case 3:n.pop();break;case 1:(s=n.peek()).type==c?s.text+=o.value:s.children.push({type:l,text:o.value});break;case 4:s=n.peek(),a={type:h,id:s.children.length,parent:s,children:[]};s.type==c&&(s.text+="{{RIGIPH:"+s.children.length+"}}"),s.children.push(a),n.push(a);break;case 5:n.pop()}}}catch(e){return console.error("Could not parse signatures in: '"+t+"'. Exception="+e),null}return r},tokenize:function(e){for(var t=RIGI.Signatures.getCurrentFormat(),n=[],r=t.format.StartEnd[0],i=t.format.PhStart[0],o=t.format.PhEnd[0];0<e.length;)if(0<(e=d.processSignatures(e,n)).length){for(var s=0;s<e.length;){var a=e[s];if(a==r)break;if(a==i)break;if(a==o)break;s++}s=Math.max(s,1),n.push({type:1,value:e.substr(0,s)}),e=e.substr(s)}return n},processSignatures:function(e,t){var n=RIGI.Signatures.getCurrentFormat();do{for(var r=!1;null!=(result=n.RX_SIGSTART.exec(e));){var i=result[0],o=result[1];if(o==n.format.PhStart||o==n.format.PhEnd)break;var s=n.decodeSignature(o);e=e.substring(i.length),t.push({type:2,value:s}),r=!0}for(;null!=(result=n.RX_PH_START.exec(e));){i=result[0];e=e.substring(i.length),t.push({type:4}),r=!0}for(;null!=(result=n.RX_PH_END.exec(e));){i=result[0];e=e.substring(i.length),t.push({type:5}),r=!0}for(;null!=(result=n.RX_SIGEND.exec(e));)e=e.substring(result[1].length),t.push({type:3}),r=!0}while(r);return e}};return d}(),function(a){var e=null;function t(){this.isActive=!0,this.scanRequested=!1,this.observer=null,this.isObserverConnected=!1,this.lastSignatureSet=null,this.ignoreElements={SCRIPT:!0,LINK:!0,OBJECT:!0,TEMPLATE:!0},this.visibleElements={OPTION:!0,SELECT:!0,LI:!0,OPTGROUP:!0,TEXT:!0,text:!0}}t.prototype.pause=function(){this.stopObserver(),this.isActive=!1},t.prototype.resume=function(){this.resumeObserver(),this.isActive=!0},t.prototype.registerNode=function(e,t){if((e.rigiSignatureTree||t&&t.rigiSignatureTree)&&this.isElementVisible(e)){var n=new a.Repository.Node(e,t);a.Repository.add(n)}},t.prototype.findSignatureTree=function(e){var n=e.rigiSignatureTree;return n||a.Utils.visitSignatureAttributes(e,function(e,t){e.rigiSignatureTree&&(n=e.rigiSignatureTree)}),n},t.prototype.onElementRightClick=function(e){var t=e.srcElement||e.target,n=this.findSignatureTree(t);if(n||(n=this.findSignatureTree(t.parentNode)),!n&&"SELECT"==t.tagName){for(var r=[],i=t.firstChild;null!=i;)i.nodeType==Node.ELEMENT_NODE&&(n=this.findSignatureTree(i)),null!=n&&r.push(i),i=i.nextSibling;for(var o=0;o<r.length;o++)if(r[o].selected){n=this.findSignatureTree(r[o]);break}null==n&&0<r.length&&(n=this.findSignatureTree(r[0]))}if(n){var s=n.getSignatures();return!s||0==s.length||(a.Events.OnElementSelected(s[0]),RIGI_Select(s[0],!1),!1)}return!0},t.prototype.configureRigiElement=function(e){var t=e,n=this,r=a.options;a.Utils.addClass(e,"rigiElement"),"OPTION"==e.tagName&&(a.Utils.addClass(e.parentNode,"rigiElement"),t=e.parentNode),r.disableSelection||t.hasRigiEventListener||(t.addEventListener?t.addEventListener("contextmenu",function(e){return e.preventDefault(),n.onElementRightClick(e)},!1):t.attachEvent("oncontextmenu",function(e){return e.preventDefault(),n.onElementRightClick(e)}),t.hasRigiEventListener=!0)},t.prototype.processElementNode=function(r){if("rigiProtect"!=r.className){var i=!1;r.rigiSignatureTree&&(this.registerNode(r,null),i=!0);var o=this;a.Utils.visitSignatureAttributes(r,function(e,t){if(t){var n=a.Parser.parse(e.value);n?(o.translateTree(n),e.value=n.toString(),i=!0,"data-rg-validation"==e.name?(n.isReadOnly=!0,r.rigiSignatureTree=n,o.registerNode(r,null)):e.rigiSignatureTree=n):console.log("Could not parse tree: "+e.value)}e.rigiSignatureTree&&o.registerNode(r,e)}),i&&this.configureRigiElement(r)}},t.prototype.processTextNode=function(e){var t=e.parentNode;if("rigiProtect"!=t.className){var n=e.data;if(a.Utils.hasSignatures(n)){n=t.innerHTML;var r=a.Parser.parse(n);r&&(this.translateTree(r),a.Utils.isHTML(r.toString())?t.innerHTML=r.toString():"text"===t.tagName?t.textContent=r.toString():t.innerText=r.toString(),t.rigiSignatureTree=r,this.configureRigiElement(t))}this.registerNode(t,null)}},t.prototype.getTranslation=function(e){var t=null;try{t=a.Events.OnGetTranslation(e)}finally{return t}},t.prototype.translateTree=function(e){for(var t=e.getSignatures(),n=0;n<t.length;n++){var r=t[n],i=this.getTranslation(r);if(null!=i)if(a.Utils.hasSignatures(i)){var o=a.Parser.parse(i);o&&e.translateTree(r,o)}else e.translate(r,i)}},t.prototype.publishSignatures=function(){var e=a.Repository.getSignatures().join(";");""==e&&""==this.lastSignatureSet||""!=e&&this.lastSignatureSet==e||(this.lastSignatureSet=e,a.Events.OnPublishSignatures(e))},t.prototype.isElementVisible=function(e){return!!e&&(e==document.documentElement||(e==document.body||(e==document.head||(e==document.title||(!!this.visibleElements[e.tagName]||0<e.offsetWidth)))))},t.prototype.processDOM=function(e){switch(e.nodeType){case a.DomNodeTypes.Element:if(this.ignoreElements[e.tagName])return;this.processElementNode(e),"IFRAME"!=e.tagName&&"FRAME"!=e.tagName||this.scanFrame(e);break;case a.DomNodeTypes.Text:this.processTextNode(e)}for(e=e.firstChild;e;)this.processDOM(e),e=e.nextSibling},t.prototype.scanFrame=function(e){try{var t=null;e.contentDocument&&e.contentDocument.documentElement?t=e.contentDocument:e.contentWindow&&e.contentWindow.document&&(t=e.contentWindow.document),t&&(RIGI.Utils.createCss(t),this.processDOM(t.documentElement))}catch(e){console.log("Could not scan iframe: "+e.message)}},t.prototype.handleMutations=function(e){for(var t=!1,n=0;n<e.length;n++){var r=e[n];switch(r.type){case"childList":case"characterData":t=!0;break;case"attributes":var i=r.oldValue,o=r.target.getAttribute(r.attributeName);if(o==i)break;"style"==r.attributeName?o&&-1<o.indexOf("display")&&(t=!0):t=!0}if(t)break}t&&this.requestScan()},t.prototype.requestScan=function(){if(!this.scanRequested){this.scanRequested=!0;var e=this;setTimeout(function(){e.rescanDOM()},a.Config.MinimumRescanTimespan)}},t.prototype.initializeObserver=function(){if(a.Config.EnableMutationObserver&&null==this.observer){var t=this;this.observer=new MutationObserver(function(e){t.handleMutations(e)}),this.resumeObserver()}},t.prototype.resumeObserver=function(){if(a.Config.EnableMutationObserver&&!this.isObserverConnected){var t=["style","class"];a.Config.SignatureAttributes.forEach(function(e){t.push(e)});var e={attributes:!0,attributeFilter:t,attributeOldValue:!0,childList:!0,subtree:!0,characterData:!0};document.documentElement&&(this.observer.observe(document.documentElement,e),this.isObserverConnected=!0)}},t.prototype.stopObserver=function(){a.Config.EnableMutationObserver&&this.isObserverConnected&&(this.observer.disconnect(),this.isObserverConnected=!1)},t.prototype.rescanDOM=function(){this.isActive&&(RIGI.options.disableCss||setTimeout(function(){RIGI.Utils.createCss(document)},100),a.Repository.clear(),this.initializeObserver(),this.stopObserver(),this.processDOM(document.documentElement),this.resumeObserver(),this.publishSignatures(),this.scanRequested=!1)},null==e&&(e=new t),a.Scanner=e}(RIGI),RIGI.Hotkey=function(r){function e(){}return e.register=function(t){document.addEventListener("keydown",function(e){e.key==t&&r.Events.OnHotkeyPressed(t)})},e.registerSelectionHotkey=function(){document.addEventListener("keydown",function(e){if(17==e.keyCode)for(var t=document.querySelectorAll(".rigiElement:hover"),n=0;n<t.length;n++)if(t[n].nodeType==Node.ELEMENT_NODE){r.Scanner.onElementRightClick({target:t[n]});break}})},e}(RIGI),function(e){e.Screenshots=e.Screenshots||{},e.extend(e.Screenshots,{Overlay:{show:function(){var e=document.getElementById("rigiScreenshotModalDialog"),t=document.getElementById("rigiScreenshotOverlay"),n=2147483647;e||((t=document.createElement("DIV")).id="rigiScreenshotOverlay",t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.height="100%",t.style.width="100%",t.style.backgroundColor="rgba(0,0,0,0.5)",t.style.zIndex=n-1,t.className="rigiIgnore",t.display="block",(e=document.createElement("DIV")).id="rigiScreenshotModalDialog",e.innerHTML="Creating HTML Preview. Please wait...",e.style.fontWeight="bold",e.style.width="360px",e.style.height="200px",e.style.lineHeight="200px",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.marginTop="-100px",e.style.marginLeft="-150px",e.style.color="#ffffff",e.style.fontFamily="Verdana",e.style.fontSize="14px",e.style.backgroundColor="#f1c40f",e.style.borderRadius="5px",e.style.textAlign="center",e.style.zIndex=n,e.className="rigiIgnore",e.display="block",document.body.insertBefore(e,document.body.firstChild),document.body.insertBefore(t,document.body.firstChild)),e.style.display="block",t.style.display="block"},hide:function(){var e=document.getElementById("rigiScreenshotModalDialog"),t=document.getElementById("rigiScreenshotOverlay");e&&(e.style.display="none"),t&&(t.style.display="none"),t.parentElement.removeChild(t),e.parentElement.removeChild(e)}}})}(RIGI),function(f){f.Screenshots=f.Screenshots||{},f.extend(f.Screenshots,{Base64:{encodeArrayBuffer:function(e){for(var t,n,r,i,o,s=new f.Utils.StringBuilder,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=new Uint8Array(e),l=u.byteLength,c=l%3,h=l-c,d=0;d<h;d+=3)t=(16515072&(o=u[d]<<16|u[d+1]<<8|u[d+2]))>>18,n=(258048&o)>>12,r=(4032&o)>>6,i=63&o,s.append(a[t]+a[n]+a[r]+a[i]);return 1==c?(t=(252&(o=u[h]))>>2,n=(3&o)<<4,s.append(a[t]+a[n]+"==")):2==c&&(t=(64512&(o=u[h]<<8|u[h+1]))>>10,n=(1008&o)>>4,r=(15&o)<<2,s.append(a[t]+a[n]+a[r]+"=")),s.toString()}}})}(RIGI),function(r){function e(e){this.url=e,this.id=++r.Screenshots.ResourceCounter,this.placeholder="{RIGIRESOURCE_"+this.id+"}",this.isLoaded=!1,this.isError=!1,this.isBinaryResource=!1,this.loaderType=r.Screenshots.LoaderTypes.Resource,this.data=""}r.Screenshots=r.Screenshots||{},r.Screenshots.ResourceCounter=0,r.Screenshots.LoaderTypes={Image:1,Resource:2,Frame:3},e.prototype.load=function(){var t=this,n=new XMLHttpRequest;"undefined"!=typeof sinon&&sinon.xhr&&sinon.xhr.XMLHttpRequest&&(n=new sinon.xhr.XMLHttpRequest),n._object&&(n=n._object),n.onreadystatechange=function(){if(4==n.readyState)if(t.isLoaded=!0,t.isError=200!=n.status,t.isError)console.warn("Could not download resource. Server responded with code: "+n.status+". URL: "+t.url);else{var e=n.getResponseHeader("Content-Type");!e||e.match(new RegExp("^text/css","i"))||e.match(new RegExp("^text/plain","i"))||e.match(new RegExp("font","i"))||e.match(new RegExp("^application/","i"))||e.match(new RegExp("^image","i"))?(t.data=t.isBinaryResource?r.Screenshots.Base64.encodeArrayBuffer(n.response):n.responseText,t.data&&0<t.data.length||console.log("Error: No data from external resource received. "+t.url)):(console.log("Invalid resoure content type: "+e+", url: "+t.url),t.data="",t.isError=!0)}},n.onerror=function(e){console.log("Failed to download resource: "+t.url),t.isLoaded=!0,t.isError=!0};try{n.open("GET",this.url),t.isBinaryResource&&(n.responseType="arraybuffer"),n.send()}catch(e){t.isLoaded=!0,t.isError=!0,console.log("Failed to download resource: "+t.url)}},r.extend(r.Screenshots,{ResourceLoader:e})}(RIGI),function(n){function e(e,t){this.imageUrl=e,this.isLoaded=!1,this.data="",this.md5="",this.id=++n.Screenshots.ResourceCounter,this.placeholder="{RIGIRESOURCE_"+this.id+"}",this.element=t,this.isBinaryResource=!0,this.loaderType=n.Screenshots.LoaderTypes.Image}n.Screenshots=n.Screenshots||{},e.prototype.convertImgToBase64=function(e,t){this.element&&"IMG"==this.element.tagName?this.convertExistingImage(t):this.convertImgCanvas(e,t)},e.prototype.convertExistingImage=function(t){var e=document.createElement("CANVAS"),n=e.getContext("2d"),r="image/png";e.height=this.element.naturalHeight,e.width=this.element.naturalWidth;try{this.element.src.match(/\.jpg$/i)&&(r="image/jpeg"),n.drawImage(this.element,0,0,e.width,e.height);var i=e.toDataURL(r,1);t.call(this,i)}catch(e){console.log("Could not load existing image."),t.call(this,null)}},e.prototype.convertImgCanvas=function(t,n){t=decodeURIComponent(t);var r=document.createElement("CANVAS"),i=r.getContext("2d"),o=document.createElement("IMG"),s="image/png";o.crossOrigin="anonymous",o.onload=function(){r.height=o.height,r.width=o.width;try{t.match(/\.jpg$/i)&&(s="image/jpeg"),i.drawImage(o,0,0,r.width,r.height);var e=r.toDataURL(s,1);n.call(this,e)}catch(e){console.log("Could not load image: "+t),n.call(this,null)}r=null},o.onerror=function(){console.log("Could not load image: "+t),n.call(this,null)};try{o.src=t}catch(e){console.log("Could not load image: "+t),n.call(this,null)}},e.prototype.load=function(){var t=this;t.convertImgToBase64(this.imageUrl,function(e){t.data=e,t.isLoaded=!0})},n.extend(n.Screenshots,{ImageLoader:e})}(RIGI),function(n){function e(e,t){this.isLoaded=!1,this.data="",this.renderCallback=t,this.id=++n.Screenshots.ResourceCounter,this.placeholder="{RIGIRESOURCE_"+this.id+"}",this.isBinaryResource=!1,this.loaderType=n.Screenshots.LoaderTypes.Frame}n.Screenshots=n.Screenshots||{},e.prototype.load=function(){var t=this;this.renderCallback(function(e){t.data=e.toString(),t.isLoaded=!0})},n.extend(n.Screenshots,{FrameLoader:e})}(RIGI),function(l){l.Screenshots=l.Screenshots||{};function e(e,t,n,r){this.sb=r,this.doc=e,this.options=t,this.loaderService=n}e.prototype.write=function(e){this.sb.append(e)},e.prototype.writeln=function(e){this.sb.append(e+"\r\n")},e.prototype.renderDom=function(){if(this.doc.styleSheets&&this.doc.styleSheets.length)for(var e=0;e<this.doc.styleSheets.length;e++)this.write("<STYLE"),null!=this.doc.styleSheets[e].media&&this.write(' media="'+this.doc.styleSheets[e].media.mediaText+'"'),this.writeln(">"),this.renderCssStyleSheet(this.doc.styleSheets[e]),this.writeln("</STYLE>");this.renderBugFixes(),this.renderFixedWidthHeightCss()},e.prototype.renderCssStyleSheet=function(e){if(console.log(e),e&&e.cssRules&&e.cssRules.length)for(var t=0;t<e.cssRules.length;t++)this.renderCssRule(e.cssRules[t])},e.prototype.renderCssRule=function(e){switch(e.type){case CSSRule.FONT_FACE_RULE:this.renderCssFontFaceRule(e);break;case CSSRule.IMPORT_RULE:this.renderCssImportRule(e);break;case CSSRule.MEDIA_RULE:this.renderCssMediaRule(e);break;case CSSRule.STYLE_RULE:this.renderCssStyleRule(e);break;default:this.writeln(e.cssText.toLowerCase())}},e.prototype.renderCssStyleRule=function(e){this.writeln(e.cssText.replace(e.selectorText,e.selectorText.toLowerCase()))},e.prototype.renderCssMediaRule=function(e){var t=e.media.mediaText.replace("\0","\\0");if(this.write("@media "+t+" { "),e.cssRules&&e.cssRules.length)for(var n=0;n<e.cssRules.length;n++)this.renderCssRule(e.cssRules[n]);this.writeln(" } ")},e.prototype.renderCssImportRule=function(e){this.writeln("/* "+e.cssText+" */"),e.styleSheet&&this.renderCssStyleSheet(e.styleSheet)},e.prototype.renderCssFontFaceRule=function(e){var i=this,t=e.cssText,o=this.doc.location.href;e.parentStyleSheet&&e.parentStyleSheet.href&&(o=e.parentStyleSheet.href);var n=[],r=[];n.push(/url\(['"]?([^"'\)\(]+\.woff[^"'\)\(]*)["']?\)/gi),r.push("application/x-font-woff"),n.push(/url\(['"]?([^"'\)\(]+\.ttf[^"'\)\(]*)["']?\)/gi),r.push("application/font-sfnt"),n.push(/url\(['"]?([^"'\)\(]+\.eot[^"'\)\(]*)["']?\)/gi),r.push("application/vnd.ms-fontobject"),n.push(/url\(['"]?([^"'\)\(]+\.svg[^"'\)\(]*)["']?\)/gi),r.push("image/svg+xml");for(var s=0;s<n.length;s++){var a=n[s],u=r[s];t=t.replace(a,function(e,t){if(t.match(/^data\:/i))return e.toString();var n=l.Path.makeUrlAbsolute(t,o),r=new l.Screenshots.ResourceLoader(n);return r.isBinaryResource=!0,i.loaderService.register(r),"url(data:"+u+";base64,"+r.placeholder+")"})}t=t.replace(/format\((.+?)\)/gi,function(e,t){return/^".+?"$/i.test(t)?"format("+t+")":'format("'+t+'")'}),this.writeln("/* "+e.cssText+" */"),this.writeln(t)},e.prototype.renderBugFixes=function(){this.writeln("<STYLE>"),this.writeln("[ng\\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak, .ng-hide { display: none !important; }"),this.writeln("ng\\:form { display: block; }"),this.writeln("</STYLE>")},e.prototype.renderFixedWidthHeightCss=function(){if(this.options.fixedWidth||this.options.fixedHeight){this.writeln("<STYLE>"),this.writeln("body { overflow: auto; ");var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.options.fixedWidth&&this.writeln("width: "+e+"px;"),this.options.fixedHeight&&this.writeln("height: "+t+"px;"),this.writeln("}"),this.writeln("</STYLE>")}},l.extend(l.Screenshots,{CssRenderer:e})}(RIGI),function(h){function e(e,t){var r=this;this.doc=t||window.document,this.sb=new h.Utils.StringBuilder,this.resourceLoaders=[],this.imageLoaders=[],this.callback=null,this.elementIdCounter=0,this.interval=null,this.options=e,this.emptyTags={BR:!0,HR:!0,META:!0,LINK:!0,IMG:!0,COL:!0,AREA:!0,PARAM:!0,EMBED:!0,BASE:!0,INPUT:!0},this.rx_resource=/\{RIGIRESOURCE_(\d+)\}/g,this.rx_url=/url\([\"\']?(.+?)[\"\']?\)/i,this.loaderService={register:function(e){(r.resourceLoaders[e.id]=e).load()},createImageLoader:function(e,t){var n=r.imageLoaders[e];return n||(n=new h.Screenshots.ImageLoader(e,t),r.imageLoaders[e]=n,(r.resourceLoaders[n.id]=n).load()),n},createFrameLoader:function(t){var n={ticket:r.options.ticket,isFrame:!0},e=new h.Screenshots.FrameLoader(t,function(e){new h.Screenshots.HtmlRenderer(n,t).render(e)});return(r.resourceLoaders[e.id]=e).load(),e}},this.cssRenderer=new h.Screenshots.CssRenderer(this.doc,this.options,this.loaderService,this.sb)}e.prototype.write=function(e){this.sb.append(e)},e.prototype.writeln=function(e){this.sb.append(e+"\r\n")},e.prototype.render=function(e){this.callback=e,this.writeHeader();var t=this;setTimeout(function(){t.options.isFrame||(h.Scanner.rescanDOM(),h.Scanner.pause()),t.renderDom(t.doc.documentElement),t.options.isFrame||(h.Scanner.resume(),h.Scanner.rescanDOM()),t.insertResourcesRecursive(e,t)},50)},e.prototype.insertResourcesRecursive=function(e,t){t.interval=setInterval(t.waitForResources,250,function(){t.insertResources()?t.insertResourcesRecursive(e):t.createHtmlFinal(e)},t)},e.prototype.createHtmlFinal=function(e){this.resourceLoaders=[],this.imageLoaders=[],e(this.sb),this.sb.clear()},e.prototype.insertResources=function(){for(var e=this.resourceLoaders.length,t=0;t<this.sb.arr.length;t++){var n=this;this.sb.arr[t]=this.sb.arr[t].replace(this.rx_resource,function(e,t){return n.resourceLoaders[t].data||""})}return this.resourceLoaders.length>e},e.prototype.writeHeader=function(){if(!this.options.isFrame){var e={signatures:h.Repository.getSignatures(),signatureFormat:h.options.signatureFormatId||3,dateCreated:Date.now().toString(),guid:h.Utils.generateUUID(),viewportWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),viewportHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),rendererVersion:"2.0"};this.write("\x3c!-- BEGIN RIGI_SCREENSHOT_HEADER"),this.write(h.json.stringify(e)),this.writeln("END RIGI_SCREENSHOT_HEADER --\x3e")}this.writeln("<!DOCTYPE html>")},e.prototype.renderDom=function(e){if(!this.skipNode(e)){var t=e;for(e=(e=this.renderNode(e)).firstChild;e;)e.nodeType==Node.ELEMENT_NODE&&"rigiIgnore"==e.className||this.renderDom(e),e=e.nextSibling;t.nodeType!=Node.ELEMENT_NODE||this.emptyTags[t.tagName]||this.renderEndElement(t)}},e.prototype.renderNode=function(e){switch(e.nodeType){case Node.ELEMENT_NODE:return this.renderElement(e);case Node.TEXT_NODE:this.renderTextNode(e)}return e},e.prototype.renderElement=function(e){switch(e.tagName){case"CANVAS":return this.renderCanvas(e);case"IFRAME":case"FRAME":return this.renderFrame(e);default:return this.renderElementDefault(e)}},e.prototype.renderFrame=function(e){return e.setAttribute("rg-uid",h.Utils.generateUUID()),this.renderElementDefault(e),e},e.prototype.renderCanvas=function(e){return e.id||(e.id="rigi_canvas_"+ ++this.elementIdCounter),this.renderElementDefault(e),e},e.prototype.renderCanvasScript=function(e){this.writeln("<script>"),this.writeln("(function(){"),this.writeln("var img = new Image; var canvas=document.getElementById('"+e.id+"'); var ctx=canvas.getContext('2d');"),this.writeln("img.onload=function(){ ctx.drawImage(img,0,0); };"),this.writeln('img.src="'+e.toDataURL()+'";'),this.writeln("})();"),this.writeln("<\/script>")},e.prototype.renderFrameScript=function(e){var t=null;if(e.contentDocument&&e.contentDocument.documentElement?t=e.contentDocument:e.contentWindow&&e.contentWindow.document&&(t=e.contentWindow.document),t){var n=e.getAttribute("rg-uid"),r=this.loaderService.createFrameLoader(t),i="tmpl_"+n;this.writeln("<template id='"+i+"'>"),this.write(r.placeholder),this.writeln("</template>")}},e.prototype.renderElementDefault=function(e){if(!e.tagName)return e;if(h.Utils.removeClass(e,"rigiElement"),h.Utils.removeClass(e,"rigiElementSelected"),e.rigiSignatureTree&&e!=this.doc.documentElement){var t=e.rigiSignatureTree.toString(!0);e.innerHTML=t}this.write("<"),this.write(e.tagName);for(var n=0;n<e.attributes.length;n++)this.renderAttribute(e,e.attributes[n]);return e.value&&!e.attributes.getNamedItem("value")&&this.write(' value="'+e.value+'"'),this.renderStyle(e),this.emptyTags[e.tagName]?this.write(" />"):this.write(">"),e==this.doc.head&&(this.write('<META charset="UTF-8" />'),this.renderCssDom(),this.renderInitScript()),e==this.doc.body&&this.renderSelect(),e},e.prototype.renderCssDom=function(){this.cssRenderer.renderDom()},e.prototype.renderSelect=function(){var e=this.doc.querySelectorAll("select");if(0!==e.length){var t={};e.forEach(function(e){return t[e.id]=e.selectedIndex});var n=JSON.stringify(t);this.writeln("<script>"),this.writeln("document.addEventListener('DOMContentLoaded', function(event) { "),this.writeln("let selectMap = JSON.parse('"+n+"')"),this.writeln("if(Object.keys(selectMap).length) {"),this.writeln("Object.keys(selectMap).forEach(s => { var sel = document.getElementById(s.toString().toLowerCase()); if(sel) sel.selectedIndex = selectMap[s]})"),this.writeln("}"),this.writeln("});"),this.writeln("<\/script>")}},e.prototype.renderInitScript=function(){0!=this.doc.querySelectorAll("iframe, frame").length&&(this.writeln("<script>"),this.writeln("(function(){"),this.writeln("function loadFrames() {"),this.writeln('var frames=document.querySelectorAll("iframe, frame");'),this.writeln("for(var i=0;i<frames.length;i++) {"),this.writeln("var frame=frames[i];"),this.writeln("frame.onload=function() {"),this.writeln("var frameUid=this.getAttribute('rg-uid');"),this.writeln("var html=document.getElementById('tmpl_' + frameUid).innerHTML;"),this.writeln("var frameDoc=this.contentDocument || this.contentWindow.document;"),this.writeln("frameDoc.open();"),this.writeln("frameDoc.write(html);"),this.writeln("frameDoc.close();"),this.writeln("frame.onload = null;"),this.writeln("this.onload = null;"),this.writeln("};"),this.writeln("frame.src='about:blank';"),this.writeln("}"),this.writeln("}"),this.writeln("document.addEventListener('DOMContentLoaded', function (ev) { loadFrames(); }, false);"),this.writeln("})();"),this.writeln("<\/script>"))},e.prototype.renderAttribute=function(e,t){var n=t.name.toLowerCase();if(!/^on/i.test(n)){var r=t.rigiSignatureTree,i=r?r.toString(!0):t.value;switch(n){case"style":return;case"href":i="#";break;case"class":case"id":case"name":i=i.toLowerCase()}if("IMG"==e.tagName&&"src"==n)i=this.loaderService.createImageLoader(i,e).placeholder;else if("INPUT"==e.tagName&&"src"==n){if("image"==e.getAttribute("type"))i=this.loaderService.createImageLoader(i,null).placeholder}else if(("IFRAME"==e.tagName||"FRAME"==e.tagName)&&"src"==n)return;this.write(" "+n+'="'+h.Utils.htmlEncode(i)+'"')}},e.prototype.renderStyle=function(e){var t=getComputedStyle(e),n=t.getPropertyValue("background-image"),r=e.attributes.style,i=r?r.value:"",o=this;if(n&&!n.match(/^none/i)&&!n.match(/^url\(data\:/i)){var s=null;try{s=e.cloneNode(!1)}catch(e){return void console.log(e)}for(var a=/^background/i,u=0;u<t.length;u++){var l=t[u];a.test(l)&&(s.style[l]=t[l])}i=(i=s.style.cssText).replace(this.rx_url,function(e,t){return"url("+o.loaderService.createImageLoader(t,null).placeholder+")"})}if(i&&0<i.length){var c="";t.opacity&&!i.includes("opacity:")&&(c=" opacity: "+t.opacity+";"),i=h.Utils.escapeQuotes(i),this.write(' style="'+i+c+'"')}},e.prototype.renderEndElement=function(e){switch(this.write("</"),this.write(e.tagName),this.write(">"),e.tagName){case"CANVAS":this.renderCanvasScript(e);break;case"IFRAME":case"FRAME":this.renderFrameScript(e)}},e.prototype.renderTextNode=function(e){this.write(e.nodeValue)},e.prototype.skipNode=function(e){if(e.nodeType==Node.ELEMENT_NODE)switch(e.tagName){case"LINK":case"STYLE":case"SCRIPT":case"NOSCRIPT":case"OBJECT":return!0;case"INPUT":return"hidden"===e.type}return!1},e.prototype.waitForResources=function(e,t){var n=!0;for(var r in t.resourceLoaders)if(t.resourceLoaders.hasOwnProperty(r)&&!t.resourceLoaders[r].isLoaded){n=!1;break}(n||0==t.resourceLoaders.length)&&(clearInterval(t.interval),e())},h.extend(h,{Screenshots:{HtmlRenderer:e}})}(RIGI),function(s){var n={};function a(){this.html=null}a.storeScreenshot=function(e,t){n[e]=t},a.getScreenshotHtml=function(e){var t=n[e];return delete n[e],t},a.prototype.render=function(o){performance.now();s.Scanner.stopObserver(),s.Screenshots.Overlay.show(),new s.Screenshots.HtmlRenderer(o,document).render(function(e){if(o.storeInDom)a.storeScreenshot(o.ticket,e.toString());else if(o.htmlCallback)o.htmlCallback(e.toString());else if(o.showPopup){window.open("","_blank","width="+screen.width+", height="+screen.height+", resizable=yes").document.write(e.toString())}else for(var t=e.toStringChunks(2097152),n=0;n<t.length;n++)s.Events.OnScreenshotFinished(t[n],n+1,t.length,o.ticket);s.Screenshots.Overlay.hide();var r=!1,i=document.getElementById("__rigi_screenshot_finished");i||(i=document.createElement("INPUT"),r=!0),i.setAttribute("type","hidden"),i.setAttribute("id","__rigi_screenshot_finished"),i.setAttribute("name","__rigi_screenshot_ticket_"+o.ticket),r&&document.body.appendChild(i),s.Scanner.resumeObserver()})},s.extend(s,{Screenshots:{ScreenshotEngine:a}})}(RIGI),RIGI.Core=function(){var i=null,n={};function o(){var t,n,r=document.getElementsByTagName("text");if(r.length){var e=document.createElement("div");e.innerHTML='<svg><filter x="0" y="0" width="1" height="1" id="solid"><feFlood flood-color="#8AC007"/><feComposite in="SourceGraphic"/></filter><filter x="0" y="0" width="1" height="1" id="selected"><feFlood flood-color="yellow"/><feComposite in="SourceGraphic"/></filter></svg>',document.body.appendChild(e)}for(var i=0;i<r.length;i++)r[i].addEventListener("mouseover",function(e){r[this.i].classList.contains("rigiElement")&&(n=r[this.i].getAttribute("filter"),r[this.i].setAttribute("filter","url(#solid)"),t=r[this.i].getAttribute("fill"),r[this.i].setAttribute("fill","#000000"))}.bind({i:i})),r[i].addEventListener("mouseleave",function(e){r[this.i].classList.contains("rigiElement")&&(r[this.i].removeAttribute("filter"),r[this.i].setAttribute("fill",t),r[this.i].setAttribute("filter",n))}.bind({i:i}))}return n.Initialize=function(e){if(!window.RIGI_IsInitialized){window.RIGI_IsInitialized=!0;var t={disableSelection:e.disableSelection||!1,disableCss:e.disableCss||!1,initialSignature:e.initialSignature||null,signatureFormatId:e.signatureFormatId||3,hotkey:e.hotkey};(RIGI.options=t).signatureFormatId&&RIGI.Signatures.setCurrentFormat(t.signatureFormatId),t.hotkey&&RIGI.Hotkey.register(t.hotkey),RIGI.Scanner.rescanDOM(),RIGI.Config.EnableTimer&&!i&&(i=window.setInterval(function(){RIGI.Scanner.requestScan()},RIGI.Config.TimerInterval)),void 0!==window.RIGI_InitialSignature?""!==window.RIGI_InitialSignature&&(RIGI_Select(RIGI_InitialSignature,!0),window.RIGI_InitialSignature=null):e.initialSignature&&RIGI_Select(t.initialSignature,!0);var n=!1,r=document.getElementById("__rigi_initialized");if(r||(r=document.createElement("INPUT"),n=!0),r.setAttribute("type","hidden"),r.setAttribute("id","__rigi_initialized"),n)(document.body||document.head).appendChild(r);window.onload=o,RIGI.Hotkey.registerSelectionHotkey(),RIGI.Events.OnInitialized()}},n.Translate=function(e,t){RIGI.Scanner.stopObserver();try{t=t||String.fromCharCode(160);var n=RIGI.Repository.getNodes(e),r=null;if(n){RIGI.Utils.hasSignatures(t)&&(r=RIGI.Parser.parse(t));for(var i=0;i<n.length;i++){var o=n[i],s=o.tree;if(!s.isReadOnly)switch(null!=r?s.translateTree(e,r)||RIGI_Log("Could not transform tree."):s.translate(e,t),o.nodeType){case RIGI.DomNodeTypes.Element:"text"===(a=o.element).tagName?a.textContent=s.toString():a.innerHTML=s.toString();break;case RIGI.DomNodeTypes.Attribute:var a=o.element,u=o.attribute,l=s.toString();a.setAttribute(u.name,l),a[u.name]=l}}}}catch(e){console.log(e)}RIGI.Scanner.resumeObserver()},n.TranslateMany=function(e){RIGI.Scanner.stopObserver();try{for(var t=0;t<e.length;t++)n.Translate(e[t].signature,e[t].text)}catch(e){console.log(e)}RIGI.Scanner.resumeObserver()},n.Select=function(e,t){RIGI.Scanner.stopObserver();for(var n=[],r=(window.frames,RIGI.Utils.getAllDocuments()),i=0;i<r.length;i++)try{for(var o=r[i].getElementsByTagName("text"),s=0;s<o.length;s++)o[s].removeAttribute("filter");if(n=r[i].getElementsByClassName("rigiElementSelected"))for(s=n.length-1;0<=s;s--)RIGI.Utils.removeClass(n[s],"rigiElementSelected")}catch(e){console.log(e.message)}var a=!0,u=RIGI.Repository.getNodes(e);if(u){var l=null;for(s=0;s<u.length;s++){var c=u[s].element;c&&("OPTION"==c.tagName&&((c=c.parentNode).selectedIndex="2"),RIGI.Utils.addClass(c,"rigiElementSelected"),"text"==c.tagName&&c.setAttribute("filter","url(#selected)"),0<c.offsetHeight&&(l=c))}l&&t&&RIGI_scrollIntoView(l,{vertical:.5,horizontal:.5,evenIfViewed:!0})}else a=!1;return RIGI.Scanner.resumeObserver(),a},n.GetSignatures=function(){return RIGI.Repository.getSignatures()},n.GetSignatureText=function(e){var t=RIGI.Repository.getNodes(e);return null==t||0==t.length?null:t[0].tree.getSignatureText(e)},n.TakeScreenshot=function(e,t){RIGI_Initialize({signatureFormatId:e.signatureFormatId||3,disableCss:!0,disableSelection:!0}),RIGI_RenderScreenshot({ticket:0,storeInDom:!1,showPopup:e.showPopup||!1,fixedWidth:!1,fixedHeight:!1,htmlCallback:e.showPopup?null:t})},n}(),window.RIGI||(window.RIGI=RIGI,window.RIGI_RenderScreenshot=RIGI_RenderScreenshot,window.RIGI_Select=RIGI_Select,window.RIGI_Translate=RIGI_Translate,window.RIGI_Initialize=RIGI_Initialize,window.RIGI_TranslateMany=RIGI_TranslateMany),window.RIGI_DisableInjection=!0,RIGI.Events.OnLoaded(),void 0!==window.RIGI_InitOptions&&RIGI_Initialize(window.RIGI_InitOptions);
})();